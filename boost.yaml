---
- name: 'Make build directory'
  file:
    path: "{{ build_dir }}"
    state: directory

- name: 'Download Boost'
  get_url:
    url: "https://sourceforge.net/projects/boost/files/boost/{{ boost_version }}/boost_{{ boost_version.replace('.', '_') }}.tar.gz/download"
    dest: "{{ build_dir }}/boost_{{ boost_version }}.tar.gz"
    validate_certs: no

- name: 'Untar boost'
  command: "tar -zxvf {{ build_dir }}/boost_{{ boost_version }}.tar.gz"
  args:
    chdir: "{{ build_dir }}"
    creates: "{{ build_dir }}/boost_{{ boost_version.replace('.', '_') }}"

- name: 'Bootstrap boost'
  command: "./bootstrap.sh"
  args:
    chdir: "{{ build_dir }}/boost_{{ boost_version.replace('.', '_') }}"

- name: 'Install boost'
  shell: "./b2 --prefix={{ puppetlabs_build_dir }} cxxflags=-fPIC cflags=-fPIC -a install"
  args:
    chdir: "{{ build_dir }}/boost_{{ boost_version.replace('.', '_') }}"
